<div class="w-full bg-card dark:bg-transparent" *transloco="let translate">
    <mat-drawer-container class="flex-auto h-full bg-card dark:bg-transparent">
        <!-- Drawer -->
        <mat-drawer #matDrawer class="w-90 sm:w-90 dark:bg-gray-900" [mode]="drawerMode" [opened]="false"
            [position]="'end'" [disableClose]="false">
            <div class="p-2">
                <div class="flex items-center ml-auto">
                    <button (click)="closeDrawer()"
                        class="text-gray-700 ml-auto hover:text-red-600 font-extrabold text-4xl leading-none px-2">
                        &times;
                    </button>
                </div>
                <!-- Display your data here -->
                <div class="flex flex-col ">
                    <div class="text-lg font-semibold mt-2">{{ 'courrierList.details' | transloco }}</div>
                    <div class="flex flex-col mt-2 border-t border-b divide-y divide-gray-300">
                        <ng-container *ngFor="let detail of drawerDetails">
                            <div class="flex items-center justify-between py-2">
                                <div class="text-blue-900">{{ detail.label }} :</div>
                                <div class="text-gray-800 text-sm">{{ detail.value }}</div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </mat-drawer>
        <!-- End Drawer -->
        <mat-drawer-content class="flex flex-col bg-gray-50 dark:bg-transparent">

            <!-- Main -->
            <div class="flex flex-col flex-auto">
                <!-- Header -->
                <div class="flex items-center justify-between sm:p-1 border-b bg-card dark:bg-transparent">
                    <div *ngIf="!isResult; then searchHeaderBlock; else resultHeaderBlock"></div>

                    <ng-template #searchHeaderBlock>
                        <div class="flex items-center space-x-2">
                            <button
                                class="border border-gray-300 text-gray-700 px-3 py-1 rounded hover:bg-gray-100 flex items-center"
                                (click)="goBack()">
                                <i class="fas fa-chevron-left mr-1"></i>
                                {{translate('common.retour')}}
                            </button>
                                                    <div class="mr-1 h-6 w-0.5 bg-gradient-to-t from-blue-500 to-blue-700"></div>

                            <h5 class="font-bold text-blue-900 ml-2">
                                {{translate('ajouterliaison.recharcherdocument')}}
                            </h5>
                        </div>
                    </ng-template>

                    <ng-template #resultHeaderBlock>
                        <div class="flex flex-wrap items-center space-x-2">
                            <button
                                class="border border-gray-300 text-gray-700 px-3 py-1 rounded hover:bg-gray-100 flex items-center"
                                (click)="back()">
                                <i class="fas fa-chevron-left mr-1"></i>
                                {{translate('common.retour')}}
                            </button>

                                                    <div class="mr-1 h-6 w-0.5 bg-gradient-to-t from-blue-500 to-blue-700"></div>


                            <h5 class="font-bold text-blue-900 flex items-center ml-2">
                                <span>{{translate('recharchecourrier.resultsearchcourrier')}}</span>
                                <span *ngIf="resultTotal > 1" class="text-gray-500 text-sm ml-2">
                                    {{ resultTotal }} {{translate('common.documents')}}
                                </span>
                                <span *ngIf="resultTotal == 1" class="text-gray-500 text-sm ml-2">
                                    {{ resultTotal }} {{translate('common.document')}}
                                </span>
                            </h5>


                        </div>
                        <!-- Right Side: View modes + buttons -->
                        <div class="flex items-center space-x-2 ml-auto">
                            <a (click)="mode(1)" class="cursor-pointer hidden md:inline-block">
                                <i class="fas fa-list" [ngClass]="{
                                    'text-blue-600': viewMode == 1,
                                    'text-gray-400': viewMode == 0
                                }"></i>
                            </a>
                            <a (click)="mode(0)">
                                <i class="fab fa-microsoft" [ngClass]="{
                                    'text-blue-600': viewMode == 0,
                                    'text-gray-400': viewMode == 1
                                }"></i>
                            </a>

                            <!-- Action buttons -->
                            <!-- <button
                            class="border border-blue-500 text-blue-500 px-3 py-1 rounded hover:bg-green-50 flex items-center"
                            (click)="sendDocs()">
                            <i class="fas fa-envelope mr-1"></i>
                            <span class="hidden sm:inline">{{ translate('common.sendemail') }}</span>
                           </button>
                            <button
                            class="border border-green-500 text-green-500 px-3 py-1 rounded hover:bg-green-50 flex items-center"
                            (click)="downloadzip()">
                            <i class="fas fa-download mr-1"></i>
                            <span class="hidden sm:inline">{{ translate('common.telecharger') }}</span>
                           </button>
                            <button
                            class="border border-red-500 text-red-500 px-3 py-1 rounded hover:bg-red-50 flex items-center"
                            (click)="deleteDocs()">
                            <i class="fas fa-trash-alt mr-1"></i>
                            <span class="hidden sm:inline">{{ translate('common.delete') }}</span>
                           </button>

                            <button *ngIf="allConfigs.RM=='1'"
                                class="border border-blue-500 text-blue-500 px-3 py-1 rounded hover:bg-blue-50 flex items-center"
                                (click)="archiveDocs()">
                                <i class="fa fa-print mr-1"></i>
                                <span class="hidden sm:inline">{{ translate('common.archive') }}</span>
                            </button>

                            <button *ngIf="!operation && resultTotal !== 0 && !isReporting"
                                class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 flex items-center"
                                (click)="saveSearch()">
                                <i class="fas fa-save mr-1"></i>
                                <span class="hidden sm:inline">{{ translate('common.save') }}</span>
                            </button>

                            <button *ngIf="operation === 'multi'"
                                class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 flex items-center"
                                (click)="valid()">
                                <i class="fas fa-check-circle mr-1"></i>
                                <span class="hidden sm:inline">{{ translate("common.valider") }}</span>
                            </button>

                            <button *ngIf="isReporting"
                                class="border border-green-500 text-green-600 px-3 py-1 rounded hover:bg-green-50 flex items-center"
                                (click)="exportAsXL()">
                                <i class="fas fa-file-excel mr-1"></i>
                                <span class="hidden sm:inline">{{ translate('common.exportexcel') }}</span>
                            </button>

                            <button *ngIf="isReporting"
                                class="border border-red-500 text-red-600 px-3 py-1 rounded hover:bg-red-50 flex items-center"
                                (click)="exportAsPDF()">
                                <i class="fas fa-file-pdf mr-1"></i>
                                <span class="hidden sm:inline">{{ translate('common.exportpdf') }}</span>
                            </button> -->
                        </div>
                    </ng-template>

                </div>
                <!-- End Header -->

                <!-- Line separator -->
                <div class="h-1 bg-blue-500">
                    <div class="h-full bg-yellow-400 w-1/5"></div>
                </div>


                <!--  Recharche -->
                <mat-tab-group class="sm:px-2" mat-stretch-tabs="false" [animationDuration]="'0'">
                    <mat-tab>
                        <ng-template matTabContent>
                            <div *ngIf="!isResult && searchtype; then searchBlock; else resultBlock"></div>
                            <ng-template #searchBlock>
                                <div class="w-full p-2 bg-white rounded-md justify-center align-content-center">
                                    <div class="max-w-7xl mx-auto px-4 shadow-md py-4  dark:bg-transparent">
                                        <form class="mt-8" [formGroup]="docFormGroup">
                                            <!-- GroupDoc -->
                                            <div class="flex items-center mb-6">
                                                <label
                                                    class="w-1/4 text-blue-900 font-semibold">{{translate('recharchedocument.groupesdocuments')}}</label>
                                                <select formControlName="GroupDoc"
                                                    class="flex-1 bg-white mt-2 border px-3 py-2 rounded">
                                                    <option value="">
                                                        {{translate('recharchedocument.aucungroupselect')}}
                                                    </option>
                                                    <option *ngFor="let gdoc of groupDoc" [value]="gdoc.goupId">
                                                        {{ gdoc.groupLabel }}
                                                    </option>
                                                </select>
                                            </div>

                                            <!-- TypeDoc -->
                                            <div class="flex items-center mb-6">
                                                <label
                                                    class="w-1/4 text-blue-900 font-semibold">{{translate('recharchedocument.typedocument')}}
                                                    :</label>
                                                <select formControlName="type" name="type" [(ngModel)]="selectedType"
                                                    (ngModelChange)="changeType($event, 1)" [items]="doctypes"
                                                    class="flex-1 bg-white mt-2 border px-3 py-2 rounded">
                                                    <option *ngFor="let type of doctypes" [ngValue]="type">{{
                                                        type.libelle }}</option>
                                                </select>
                                            </div>


                                            <!-- Dynamic Attributes -->
                                            <div formArrayName="attrs">
                                                <div class="space-y-4"
                                                    *ngFor="let a of attrsForms.controls; let i = index"
                                                    [hidden]="attributes[i].type.name == 'fichier' || attributes[i]['visib'] == 0"
                                                    [formGroupName]="i">
                                                    <ng-container>

                                                        <!-- Simple input -->
                                                        <div class="flex items-center" *ngIf="
                                                        attributes[i].type.name != 'fichier' &&
                                                        attributes[i].type.name != 'longtext' &&
                                                        attributes[i].type.name != 'List' &&
                                                        attributes[i].type.name != 'listDb' &&
                                                        attributes[i].type.name != 'ListDep' &&
                                                        attributes[i].type.name != 'date'
                                                      ">
                                                            <label *ngIf="attributes[i].name != 'Fichier'"
                                                                class="w-1/4 text-blue-900 font-semibold">
                                                                {{ attributes[i].libelle}} :
                                                            </label>
                                                            <input formControlName="val" (keyup)="searchButton($event)"
                                                                (keypress)="config.clsAlphaNoOnly($event)"
                                                                [type]="attributes[i].type.name"
                                                                class="flex-1 bg-white mt-2 px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                                                        </div>

                                                        <!-- Select / select -->
                                                        <div class="flex items-center" *ngIf="
                                                        attributes[i].type.name == 'List' ||
                                                        attributes[i].type.name == 'listDb' ||
                                                        attributes[i].type.name == 'ListDep'
                                                      ">
                                                            <label *ngIf="attributes[i].name != 'Fichier'"
                                                                class="w-1/4 text-blue-900 font-semibold">
                                                                {{ attributes[i].libelle}}:
                                                            </label>
                                                            <ng-container *ngIf="attributes[i].name != 'owner'">
                                                                <select (change)="changeValue($event, attributes[i])"
                                                                    formControlName="val"
                                                                    [items]="$any(attributes[i].type.name == 'ListDep' ? depArrays : mappedArray)['id' + attributes[i].id]"
                                                                    bindLabel="value" bindValue="key"
                                                                    class="flex-1 bg-white mt-2 border px-3 py-2 rounded">
                                                                    <ng-template ng-option-tmp let-item="item">
                                                                        <div container="body" [openDelay]="300"
                                                                            [closeDelay]="500" placement="top"
                                                                            tooltipClass="tooltipl-class"
                                                                            [ngbTooltip]="item.value">
                                                                            {{ item.value }}
                                                                        </div>
                                                                    </ng-template>
                                                                </select>
                                                            </ng-container>
                                                        </div>

                                                        <!-- Long text -->
                                                        <div class="flex items-start"
                                                            *ngIf="attributes[i].type.name == 'longtext'">
                                                            <label *ngIf="attributes[i].name != 'Fichier'"
                                                                class="w-1/4 text-blue-900 font-bold pt-2">
                                                                {{ attributes[i].libelle}} :
                                                            </label>
                                                            <textarea formControlName="val"
                                                                class="flex-1 bg-white mt-2 px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                                                        </div>

                                                        <!-- Date range -->
                                                        <div class="flex items-center"
                                                            *ngIf="attributes[i].type.name == 'date'">
                                                            <label class="w-1/4 text-blue-900 font-semibold">
                                                                {{ attributes[i].libelle }}:
                                                            </label>
                                                            <div class="flex items-center gap-2 flex-1 bg-white mt-2">
                                                                <input *ngIf="attrsForms.at(i).get('from')"
                                                                    formControlName="from" type="date" max="9999-12-31"
                                                                    class="w-1/2 px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                                                                <span
                                                                    class="text-sm font-medium text-slate-700">{{translate('common.au')}}</span>
                                                                <input *ngIf="attrsForms.at(i).get('to')"
                                                                    formControlName="to" type="date" max="9999-12-31"
                                                                    class="w-1/2 px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" />
                                                            </div>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>



                                            <!-- Buttons -->
                                            <div class="flex justify-end gap-4 mt-6">
                                                <button type="button" [disabled]="sel == null" (click)="getResult()"
                                                    class="flex items-center px-2 py-1 bg-blue-500 border border-transparent rounded-md text-white hover:bg-blue-600">
                                                    <i class="fa fa-search mr-1"></i>{{translate('common.rechercher')}}
                                                </button>

                                                <button id="clear" (click)="clear($event)"
                                                    class="flex items-center px-2 py-1 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50"
                                                    [disabled]="!docFormGroup.dirty">
                                                    <i class="fas fa-undo mr-1"></i>{{translate('common.annuler')}}
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>

                            </ng-template>



                            <!-- result -->
                            <ng-template #resultBlock>
                                <div class="w-full p-2 bg-white rounded-md justify-center align-content-center"
                                    *ngIf="searchtype && isResult">
                                    <!-- Table -->
                                    <ng-container *ngIf="viewMode == 1">
                                        <div class="w-full" *ngIf="totalCheck > 0">
                                            <table class="documents-table w-full mx-auto border-2 border-blue-400 rounded-md shadow-lg text-left text-md whitespace-nowrap">
                                                <thead
                                                    style="background-color: var(--header-color);color:var(--white-color)">
                                                    <tr>
                                                        <th *ngIf="link == null" class="w-[8%] px-2 py-2 relative">
                                                            <button
                                                                class="w-full flex items-center justify-between text-white font-medium px-2 py-1 rounded focus:outline-none"
                                                                (click)="isDropdownOpen = !isDropdownOpen">
                                                                <span> {{translate('common.selectionner')}}</span>
                                                                <i class="fas" [ngClass]="{
                                                                  'fa-chevron-up': isDropdownOpen,
                                                                  'fa-chevron-down': !isDropdownOpen
                                                                }"></i>
                                                            </button>

                                                            <div *ngIf="isDropdownOpen"
                                                                class="absolute left-0 mt-1 w-28 bg-white border border-gray-300 rounded shadow-md z-50">
                                                                <a class="block px-3 py-1 text-sm text-gray-600 hover:bg-gray-100"
                                                                    [ngClass]="{ 'pointer-events-none opacity-50': isPageSeleced }"
                                                                    (click)="selectAll($event); isDropdownOpen = false">{{translate('common.selectionnerpage')}}</a>
                                                                <a class="block px-3 py-1 text-sm text-gray-600 hover:bg-gray-100"
                                                                    [ngClass]="{ 'pointer-events-none opacity-50': selectedDocs.length == resultTotal }"
                                                                    (click)="selectAll($event); isDropdownOpen = false">{{translate('common.selectionnertout')}}</a>
                                                                <div class="border-t border-gray-200 my-1"></div>
                                                                <a class="block px-3 py-1 text-sm text-gray-600 hover:bg-gray-100"
                                                                    [ngClass]="{ 'pointer-events-none opacity-50': selectedDocs.length == 0 }"
                                                                    (click)="unSelectAll(); isDropdownOpen = false">{{translate('common.deselectionner')}}</a>
                                                            </div>
                                                        </th>


                                                        <th class="p-1 text-center">{{translate('common.document')}}
                                                        </th>
                                                        <th class="px-2 py-1 text-center">
                                                            {{translate('common.nclient')}}
                                                            <a href="" class="inline">
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    viewBox="0 0 320 512"
                                                                    class="w-[0.75rem] h-[0.75rem] inline ml-1 text-white mb-[1px]"
                                                                    fill="currentColor">
                                                                    <path
                                                                        d="M137.4 41.4c12.5-12.5 32.8-12.5 45.3 0l128 128c9.2 9.2 11.9 22.9 6.9 34.9s-16.6 19.8-29.6 19.8H32c-12.9 0-24.6-7.8-29.6-19.8s-2.2-25.7 6.9-34.9l128-128zm0 429.3l-128-128c-9.2-9.2-11.9-22.9-6.9-34.9s16.6-19.8 29.6-19.8H288c12.9 0 24.6 7.8 29.6 19.8s2.2 25.7-6.9 34.9l-128 128c-12.5 12.5-32.8 12.5-45.3 0z" />
                                                                </svg>
                                                            </a>
                                                        </th>
                                                        <th class="p-1 text-center">
                                                            {{translate('common.dateenregistrement')}}
                                                            <a href="" class="inline">
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    viewBox="0 0 320 512"
                                                                    class="w-[0.75rem] h-[0.75rem] inline ml-1 text-white mb-[1px]"
                                                                    fill="currentColor">
                                                                    <path
                                                                        d="M137.4 41.4c12.5-12.5 32.8-12.5 45.3 0l128 128c9.2 9.2 11.9 22.9 6.9 34.9s-16.6 19.8-29.6 19.8H32c-12.9 0-24.6-7.8-29.6-19.8s-2.2-25.7 6.9-34.9l128-128zm0 429.3l-128-128c-9.2-9.2-11.9-22.9-6.9-34.9s16.6-19.8 29.6-19.8H288c12.9 0 24.6 7.8 29.6 19.8s2.2 25.7-6.9 34.9l-128 128c-12.5 12.5-32.8 12.5-45.3 0z" />
                                                                </svg>
                                                            </a>

                                                        </th>
                                                        <th class="p-1 text-center">{{translate('common.proprietaire')}}
                                                            <a href="" class="inline">
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    viewBox="0 0 320 512"
                                                                    class="w-[0.75rem] h-[0.75rem] inline ml-1 text-white mb-[1px]"
                                                                    fill="currentColor">
                                                                    <path
                                                                        d="M137.4 41.4c12.5-12.5 32.8-12.5 45.3 0l128 128c9.2 9.2 11.9 22.9 6.9 34.9s-16.6 19.8-29.6 19.8H32c-12.9 0-24.6-7.8-29.6-19.8s-2.2-25.7 6.9-34.9l128-128zm0 429.3l-128-128c-9.2-9.2-11.9-22.9-6.9-34.9s16.6-19.8 29.6-19.8H288c12.9 0 24.6 7.8 29.6 19.8s2.2 25.7-6.9 34.9l-128 128c-12.5 12.5-32.8 12.5-45.3 0z" />
                                                                </svg>
                                                            </a>
                                                        </th>
                                                        <th class="p-1 text-center">{{ link ? translate('common.link') :
                                                            translate('common.actions')
                                                            }}

                                                        </th>
                                                        <th class="p-1 text-center">{{translate('common.details')}}

                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let document of documentSearch | paginate : { id: 'id1', itemsPerPage: 18, currentPage: page + 1, totalItems: resultTotal }; let index = index"
                                                        [class]="index % 2 === 0 ? 'bg-white' : 'bg-zinc-200'">
                                                        <td *ngIf="link == null" class="px-2 py-1 text-center">
                                                            <input type="checkbox"
                                                                [checked]="selectedDocs.indexOf(getValue('id', document)) != -1"
                                                                (change)="addToList($event, document)" />
                                                        </td>

                                                        <td class="p-1 text-center" (click)="openViewer(document)">
                                                            <i
                                                                [ngClass]="getFontAwesomeIconFromMIME(document[3]?.value)"></i>
                                                        </td>



                                                        <td class="px-2 py-1 text-center"
                                                            [ngbTooltip]="varDocs[index].titre"
                                                            tooltipClass="tooltipl-class">
                                                            {{ varDocs[index].titre }}
                                                        </td>
                                                        <td class="px-2 py-1 text-center">
                                                            {{ varDocs[index].dateS | date: 'dd-MM-yyyy HH:mm:ss' }}
                                                        </td>
                                                        <td class="px-2 py-1 text-center">
                                                            {{ document[4]?.value }}
                                                        </td>
                                                        <td class="text-center">
                                                            <div *ngIf="link == null"
                                                                class="flex items-center justify-center gap-1 text-blue-500">
                                                                <button (click)="send(document)">
                                                                    <i
                                                                        class="fas fa-envelope hover:text-blue-700 transition"></i>
                                                                </button>
                                                                <button (click)="downloadFile(document)">
                                                                    <i
                                                                        class="fas fa-download hover:text-blue-700 transition"></i>
                                                                </button>
                                                                <button *ngIf="documentIconShow"
                                                                    (click)="sendIt(document)">
                                                                    <i
                                                                        class="fas fa-share-alt hover:text-blue-700 transition"></i>
                                                                </button>
                                                                <button [matMenuTriggerFor]="menu">
                                                                    <i class="fas fa-caret-down"></i>
                                                                </button>

                                                                <mat-menu #menu="matMenu" class="py-0">
                                                                    <ng-container>
                                                                        <button class="custom-menu-item"
                                                                            (click)="getDocToUp(document)">
                                                                            <i class="fas fa-edit ml-2"></i>
                                                                            <span
                                                                                class="mr-2 ml-2">{{translate('common.modifier')}}</span>
                                                                        </button>
                                                                        <mat-divider></mat-divider>
                                                                    </ng-container>

                                                                    <ng-container
                                                                        *ngIf="hideExportation && document['document']['archiveCm'] == 0">
                                                                        <a class="custom-menu-item"
                                                                            (click)="exportDocument(document['document'], folder.id)">
                                                                            <i class="fas fa-edit ml-2"></i>
                                                                            <span
                                                                                class="mr-2 ml-2">{{translate('common.archivecm')}}</span>
                                                                        </a>
                                                                        <mat-divider></mat-divider>
                                                                    </ng-container>

                                                                    <a class="custom-menu-item"
                                                                        (click)="setDocId(document)">
                                                                        <i class="fas fa-unlink ml-2"></i>
                                                                        <span
                                                                            class="mr-2 ml-2">{{translate('common.detacher')}}</span>
                                                                    </a>
                                                                    <mat-divider></mat-divider>

                                                                    <ng-container *ngIf="document['3']['value']">
                                                                        <ng-container
                                                                            *ngIf="document['3']['value'] == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ">
                                                                            <a class="custom-menu-item"
                                                                                (click)="exportWordPdf(document)">
                                                                                <i class="fas fa-file-pdf-o ml-2"></i>
                                                                                <span
                                                                                    class="mr-2 ml-2">{{translate('common.exportpdf')}}</span>
                                                                            </a>
                                                                            <mat-divider></mat-divider>
                                                                        </ng-container>
                                                                    </ng-container>

                                                                    <a class="custom-menu-item"
                                                                        (click)="version(document)">
                                                                        <i class="fas fa-code-branch ml-2"></i>
                                                                        <span
                                                                            class="mr-2 ml-2">{{translate('common.anciennesversions')}}</span>
                                                                    </a>
                                                                    <mat-divider></mat-divider>

                                                                    <a class="custom-menu-item"
                                                                        (click)="onDelete(document)">
                                                                        <i
                                                                            class="text-red-500 fas fa-trash-alt ml-2"></i>
                                                                        <span
                                                                            class="text-red-500 mr-2 ml-2">{{translate('common.delete')}}</span>
                                                                    </a>
                                                                </mat-menu>

                                                            </div>
                                                            <a *ngIf="link == 'true'" (click)="linkClick(document)"><i
                                                                    class="fa fa-link" aria-hidden="true"></i></a>

                                                        </td>
                                                        <td class="p-1 text-center">
                                                            <a (click)="openDetailsDrawer(document.document)"
                                                                class="text-blue-500 hover:text-blue-700">
                                                                <i class="fas fa-info-circle"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!-- Pagination -->
                                            <div class="flex justify-center mt-4" *ngIf="totalCheck > 18">
                                                <pagination-controls [previousLabel]="translate('common.precedent')"
                                                    [nextLabel]="translate('common.suivant')" directionLinks="true"
                                                    autoHide="true" responsive="true"
                                                    screenReaderPaginationLabel="Pagination"
                                                    screenReaderPageLabel="page"
                                                    screenReaderCurrentLabel="You're on page"
                                                    (pageChange)="goPage($event - 1)"
                                                    maxSize="14"></pagination-controls>
                                            </div>

                                        </div>
                                    </ng-container>

                                    <!-- Mosaique -->
                                    <ng-container *ngIf="viewMode == 0">
                                        <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4 px-2">
                                            <div *ngFor="let document of documentSearch | paginate : {itemsPerPage: 18,currentPage: page + 1,totalItems: resultTotal};let index = index"
                                                (mouseover)="row = index" (mouseleave)="row = -1">
                                                <app-doc (detailsClick)="triggerDetailsDrawer(document)"
                                                    (selectedDoc)="linkClick($event)" [mode]="state" [doc]="document"
                                                    [file]="getValue('fileName', document)">
                                                    <div class="relative inline-block text-left" contextmenu>
                                                        <a [matMenuTriggerFor]="menu" class="cursor-pointer">
                                                            <i class="fas fa-ellipsis-h"></i>
                                                        </a>
                                                        <mat-menu #menu="matMenu"
                                                            class="absolute left-0 w-20 py-0 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5">

                                                            <a (click)="send(document)"
                                                                class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer">
                                                                <i class="fas fa-envelope mr-2 ml-2"></i>
                                                                <span
                                                                    class="mr-2">{{translate('common.sendemail')}}</span>
                                                            </a>



                                                            <a (click)="downloadFile(document)"
                                                                class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer">
                                                                <i class="fas fa-download mr-2 ml-2"></i>
                                                                <span
                                                                    class="mr-2">{{translate('common.telecharger')}}</span>
                                                            </a>



                                                            <a *ngIf="documentIconShow" (click)="sendIt(document)"
                                                                class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer">
                                                                <i class="fas fa-share mr-2 ml-2"></i>
                                                                <span
                                                                    class="mr-2">{{translate('common.partager')}}</span>
                                                            </a>



                                                            <a (click)="getDocToUp(document)"
                                                                class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer">
                                                                <i class="fas fa-edit mr-2 ml-2"></i>
                                                                <span
                                                                    class="mr-2">{{translate('common.modifier')}}</span>
                                                            </a>



                                                            <a *ngIf="allConfigs.RM == '1' && getValue('Archive', document) == '0'"
                                                                (click)="archiveElement(document)"
                                                                class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer">
                                                                <i class="fas fa-archive mr-2 ml-2"></i>
                                                                <span
                                                                    class="mr-2">{{translate('common.archive')}}</span>
                                                            </a>



                                                            <a *ngIf="allConfigs.RM == '1' && getValue('Archive', document) == '1'"
                                                                class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer"
                                                                (click)="reserverElement(document)">
                                                                <i class="fas fa-archive mr-2"></i>
                                                                {{translate('common.detailsacrchive')}}
                                                            </a>

                                                            <ng-container *ngIf="document['3']">
                                                                <a *ngIf="document['3']['value'] === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'"
                                                                    class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer"
                                                                    (click)="exportWordPdf(document)">
                                                                    <i class="fas fa-file-pdf-o mr-2"></i>
                                                                    {{translate('common.exportpdf')}}
                                                                </a>


                                                                <a class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer"
                                                                    (click)="setDocId(document)">
                                                                    <i class="fas fa-unlink mr-2"></i>
                                                                    {{translate('common.detacher')}}
                                                                </a>



                                                                <a class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer"
                                                                    (click)="version(document)">
                                                                    <i class="far fa-copy mr-2"></i>
                                                                    {{translate('common.anciennesversions')}}
                                                                </a>



                                                                <a class="flex items-center px-1 py-0 text-sm text-gray-700 hover:bg-gray-50 cursor-pointer"
                                                                    (click)="onDelete(document)">
                                                                    <span class="text-red-600">
                                                                        <i class="fas fa-trash-alt mr-2"></i>
                                                                    </span>
                                                                    {{translate('common.delete')}}
                                                                </a>
                                                            </ng-container>

                                                        </mat-menu>
                                                    </div>
                                                </app-doc>

                                            </div>
                                        </div>

                                    </ng-container>
                                    <!-- Pagination -->
                                    <div class="flex justify-center py-4" *ngIf="resultTotal > 18 && totalCheck > 0">
                                        <div class="w-auto">
                                            <pagination-controls directionLinks="true" autoHide="true" responsive="true"
                                                [previousLabel]="translate('common.precedent')"
                                                [nextLabel]="translate('common.suivant')"
                                                screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
                                                screenReaderCurrentLabel="You're on page" (pageChange)="pageC($event)"
                                                maxSize="14" class="flex gap-1 items-center"></pagination-controls>
                                        </div>
                                    </div>
                                    <!-- End Pagination -->

                                    <!-- Loading -->
                                    <div *ngIf="totalCheck == -1" class="text-center my-8">
                                        <div class="flex justify-center items-center">
                                            <div
                                                class="text-center items-center border-gray-300 h-15 w-15 animate-spin rounded-full border-8 border-t-blue-600">
                                            </div>
                                        </div>
                                        <h3 class="text-muted mt-4">{{translate('courrierList.load')}}</h3>
                                    </div>
                                    <!-- End Loading -->
                                    <!-- Pas Accesss -->
                                    <div class="w-full mt-12" *ngIf="totalCheck == -2">
                                        <div class="flex justify-center my-6">
                                            <h1>
                                                <div class="text-4xl text-blue-600">
                                                    <i class="fas fa-user-lock"></i>
                                                </div>
                                            </h1>
                                        </div>
                                        <div class="flex justify-center my-4">
                                            <h3 class="text-gray-500 text-lg">
                                                {{translate('common.pasAcces')}}
                                            </h3>
                                        </div>
                                    </div>
                                    <!-- End Pas Access -->
                                    <!-- 0 Doc -->
                                    <div class="w-full mt-12" *ngIf="totalCheck == 0">
                                        <div class="flex justify-center my-6">
                                            <h1>
                                                <i class="fa fa-search text-gray-400 text-4xl" aria-hidden="true"></i>
                                            </h1>
                                        </div>
                                        <div class="flex justify-center my-4">
                                            <h3 class="text-gray-500 text-lg">
                                                {{translate('common.0docpartager')}}
                                            </h3>
                                        </div>
                                    </div>
                                    <!-- End 0 Doc -->
                                </div>



                                <div class="w-full p-2 bg-white rounded-md justify-center align-content-center"
                                    *ngIf="!searchtype && isResult">

                                    <!-- 0 Doc -->
                                    <div class="w-full mt-12" *ngIf="resultTotal == 0">
                                        <div class="flex justify-center my-6">
                                            <h1>
                                                <i class="fa fa-search text-gray-400 text-4xl" aria-hidden="true"></i>
                                            </h1>
                                        </div>
                                        <div class="flex justify-center my-4">
                                            <h3 class="text-gray-500 text-lg">
                                                {{translate('common.0docpartager')}}
                                            </h3>
                                        </div>
                                    </div>
                                    <!--  -->
                                    <div class="flex flex-col md:flex-row gap-4 w-full" *ngIf="showDocuments">
                                        <div class="w-full overflow-x-auto">
                                            <table class="min-w-full border border-gray-300 text-sm text-left">
                                                <thead class="bg-blue-500 text-white">
                                                    <tr>
                                                        <th class="w-[10%] px-3 py-2">{{translate('common.document')}}
                                                        </th>
                                                        <th class="w-[15%] px-3 py-2">{{translate('common.type')}}</th>
                                                        <th class="w-[15%] px-3 py-2">{{ attrLib['titre'] }}</th>
                                                        <th class="px-3 py-2">{{trasnlate('common.dateenregistrement')}}
                                                        </th>
                                                        <th class="w-[10%] px-3 py-2">{{ link ? translate('common.lier')
                                                            : translate('common.actions') }}</th>
                                                        <th class="w-[10%] px-3 py-2">{{trasnlate('common.details')}}
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-white divide-y divide-gray-200">
                                                    <tr *ngFor="let document of documents | paginate: { itemsPerPage: 12, currentPage: page + 1, totalItems: resultTotal }; let index = index"
                                                        class="hover:bg-gray-100" (mouseover)="row = index"
                                                        (mouseleave)="row = -1">
                                                        <td class="px-3 py-2 cursor-pointer"
                                                            (click)="openViewerF(document['id'], document['fileName'])">
                                                            <i [ngClass]="getFontAwesomeIconFromMIME(document['contentType'])"
                                                                class="text-blue-600 text-lg"></i>
                                                        </td>
                                                        <ng-container
                                                            *ngFor="let attributesvalues of document['attributeValues']">
                                                            <td *ngIf="attributesvalues.attribute.name == 'Titre'"
                                                                class="px-3 py-2" [ngbTooltip]="varDocs[index].titre">
                                                                {{ varDocs[index].titre }}
                                                            </td>
                                                        </ng-container>
                                                        <td class="px-3 py-2">{{ document['upload_date'] | date:
                                                            'dd-MM-yyyy HH:mm:ss' }}</td>
                                                        <td class="px-3 py-2">
                                                            <div class="flex gap-2" [class.hidden]="row !== index">
                                                                <a (click)="sendF(document)"><i
                                                                        class="fas fa-envelope text-blue-600"></i></a>
                                                                <a (click)="downloadFile(document['id'])"><i
                                                                        class="fas fa-download text-blue-600"></i></a>
                                                                <a *ngIf="documentIconShow"
                                                                    (click)="sendItF(document['id'])"><i
                                                                        class="fas fa-share-alt text-blue-600"></i></a>
                                                            </div>
                                                        </td>
                                                        <td class="px-3 py-2">
                                                            <a class="cursor-pointer" (click)="btnPlusInfosF(document)">
                                                                <i class="fas fa-info text-blue-600"
                                                                    [ngbTooltip]="config.c['documentSearch']['details']"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <div class="flex justify-center py-4" *ngIf="resultTotal > 12">
                                                <pagination-controls directionLinks="true" autoHide="true"
                                                    responsive="true" [previousLabel]="translate('common.precedent')"
                                                    [nextLabel]="translate('common.suivant')"
                                                    (pageChange)="goPageT($event)" maxSize="14">
                                                </pagination-controls>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                        </ng-template>
                    </mat-tab>
                </mat-tab-group>

                <!-- Recharche -->

            </div>
        </mat-drawer-content>
    </mat-drawer-container>
</div>
